re modeled and added control for pid tuning.